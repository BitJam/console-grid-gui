#!/bin/bash

lib_dir=/usr/lib/shell
loc_lib=./lib
test -e $loc_lib/lib-screen.sh && lib_dir=$loc_lib
. $lib_dir/lib-screen.sh
. $lib_dir/lib-grid.sh


main() {
    MAIN_MENU="$(make_main_menu)"

    #grid_color_scheme light

    screen_set title1=$"antiX Command-Line Control Centre"
    screen_set title2=$"Press: <Enter> to select an option, <q> to quit, <h> for help"
    screen_set box=-s border=1

    init

    hide_tty
    clear
    redraw
    main_loop
}

init() {
    screen_init
    grid_read_new antix_cc "$MAIN_MENU"
    grid_narrow y=3 title=$"Main Menu"
    grid_center_x
    grid_fill_y 50
    grid_finalize
}

redraw() {
    screen_draw
    grid_activate
}

restart() {
    local save_sel=$GRID_SEL
    local save_def=$GRID_DEFAULT_SEL
    init
    GRID_SEL=$save_sel
    GRID_DEFAULT_SEL=$save_def
    clear
    redraw
}

antix_cc_on_enter() {
    local name=$1 sel=$3
    GRID_DEFAULT_SEL=$sel
    grid_activate
    case $name in
        "Live System") bin/cli-live-cc  ;;
        *) db_msg "Would do action %s" "$white$name" ; return ;;
    esac

    clear
    printf $cursor_off
    redraw
    return
}

make_main_menu() {
    echo "Audio/Visual programs"
    echo "Internet"
    echo "System Info"
    echo "Installer"
    echo "Live System"
    echo "Utilities"
    echo "Office"
    echo "Text Editors"
    echo "reboot"
    echo "poweroff"
}

HELP_PAGE=$ME

[ "$DEBUG" ] || log_file=/dev/null

main "$@" 2>> $log_file



